<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login to Avis</title>
    <link rel="stylesheet" href="./style/Login.css">
    
</head>

<body>

    <div class="logpopup" id="logpopup">
        <div id="loghead">
            <div id="logsignIn_head">
                <h1>LOG IN</h1>
                <h3>NEW TO AVIS?</h3>
                <a href="./signup.html">SIGN UP</a>
            </div>
            <div id="logcross-cont">
                <p id="logcross" onclick="logclosePopup()">â¨‰</p>
            </div>
        </div>

        <form action="" id="logform">
            <input type="email" placeholder="email" name="femail" id="logemail"><span id="logemail_error"></span>

            <input type="password" placeholder="PASSWORD" name="fpassword" id="logpassword"><span
                id="logpassword_error"></span>

            <input id="logLogin_but" type="submit" value="LOG IN">
        </form>
        <h3 id="logor">---OR---</h3>
        <div id="logFb_Gog_but">

            <button id="loggoogle">
                <div>
                    <b>
                        <p>G</p>
                    </b>
                </div>
                <div class="loganchor"><a href="">LOG IN WITH GOOGLE</a></div>
            </button>
            <button id="logfacebook">
                <div>
                    <b>
                        <p>f</p>
                    </b>
                </div>
                <div class="loganchor"><a href="">LOG IN WITH FACEBOOK</a></div>
            </button>
        </div>

    </div>

    <button id="clickme" onclick="logopenPopup()">Click Me</button>
</body>
<script>

    let myform = document.getElementById("logform")

    let email_error = document.getElementById("logemail_error")

    let password_error = document.getElementById("logpassword_error")


    myform.addEventListener("submit", (e) => {
        e.preventDefault();
        var userData = {

            email: myform.email.value,
            password: myform.password.value,
        }

        //    validation of form

        if (userData.email !== "" && userData.password.length !== 0) {
            email_error.innerHTML = null; password_error.innerHTML = null;
            login_User(userData)
        } else {
            userData.email == "" ? email_error.innerHTML = "*Enter Email!"
                : email_error.innerHTML = null;

            userData.password.length == 0 ? password_error.innerHTML = "*Enter Password!"
                : password_error.innerHTML = null;
        }


    })


    function login_User(obj) {
        fetch("https://63c67422dcdc478e15c1bf8d.mockapi.io/users")
            .then(responseObject => responseObject.json())
            .then((data) => {
                //   console.log(data)
                let flag = false;
                var element = "";
                data.forEach((item) => {
                    if (item.email == obj.email && item.password == obj.password) {
                        element = item;
                        flag = true;

                    }
                })
                if (flag == true) {
                     localStorage.setItem("loginUser",JSON.stringify(element))
                    alert(`Congratulation ${element.firstname} ${element.lastname}, Explore your dream journey with GhumOCaR`)
                    location.href = "./homepage.html"
                } else {
                    password_error.innerHTML = "Username and password may be incorrect!"
                }
            })

    }


    let popup = document.getElementById("logpopup");

    function logopenPopup() {
        popup.classList.add("logopen-popup");
        console.log("hello")
    }
    function logclosePopup() {
        popup.classList.remove("logopen-popup");
    }





</script>

</html>