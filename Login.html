<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login to Avis</title>
    <link rel="stylesheet" href="./style/Login.css">
    
</head>

<body>

    <div class="popup" id="popup">
        <div id="head">
            <div id="signIn_head">
                <h1>LOG IN</h1>
                <h3>NEW TO AVIS?</h3>
                <a href="./signup.html">SIGN UP</a>
            </div>
            <div id="cross-cont">
                <p id="cross" onclick="closePopup()">â¨‰</p>
            </div>
        </div>

        <form action="" id="form">
            <input type="email" placeholder="email" name="femail" id="email"><span id="email_error"></span>

            <input type="password" placeholder="PASSWORD" name="fpassword" id="password"><span
                id="password_error"></span>

            <input id="Login_but" type="submit" value="LOG IN">
        </form>
        <h3 id="or">---OR---</h3>
        <div id="Fb_Gog_but">

            <button id="google">
                <div>
                    <b>
                        <p>G</p>
                    </b>
                </div>
                <div class="anchor"><a href="">LOG IN WITH GOOGLE</a></div>
            </button>
            <button id="facebook">
                <div>
                    <b>
                        <p>f</p>
                    </b>
                </div>
                <div class="anchor"><a href="">LOG IN WITH FACEBOOK</a></div>
            </button>
        </div>

    </div>

    <button id="clickme" onclick="openPopup()">Click Me</button>
</body>
<script>

    let myform = document.getElementById("form")

    let email_error = document.getElementById("email_error")

    let password_error = document.getElementById("password_error")


    myform.addEventListener("submit", (e) => {
        e.preventDefault();
        var userData = {

            email: myform.email.value,
            password: myform.password.value,
        }

        //    validation of form

        if (userData.email !== "" && userData.password.length !== 0) {
            email_error.innerHTML = null; password_error.innerHTML = null;
            login_User(userData)
        } else {
            userData.email == "" ? email_error.innerHTML = "*Enter Email!"
                : email_error.innerHTML = null;

            userData.password.length == 0 ? password_error.innerHTML = "*Enter Password!"
                : password_error.innerHTML = null;
        }


    })


    function login_User(obj) {
        fetch("https://63c67422dcdc478e15c1bf8d.mockapi.io/users")
            .then(responseObject => responseObject.json())
            .then((data) => {
                //   console.log(data)
                let flag = false;
                var element = "";
                data.forEach((item) => {
                    if (item.email == obj.email && item.password == obj.password) {
                        element = item;
                        flag = true;

                    }
                })
                if (flag == true) {
                     localStorage.setItem("loginUser",JSON.stringify(element))
                    alert(`Congratulation ${element.firstname} ${element.lastname}, Explore your dream journey with GhumOCaR`)
                    location.href = "./home.html"
                } else {
                    password_error.innerHTML = "Username and password may be incorrect!"
                }
            })

    }


    let popup = document.getElementById("popup");

    function openPopup() {
        popup.classList.add("open-popup");
    }
    function closePopup() {
        popup.classList.remove("open-popup");
    }





</script>

</html>